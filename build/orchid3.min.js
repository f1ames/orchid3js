/* orchid3.js by Krzysztof Krzto≈Ñ (aka f1ames). id3 algorithm in js. */

window.orchid3=window.orchid3||{},function(a){a.Util={parseData:function(a,b,c){var d=[],e=a.replace(/\r?\n|\r/g,"").split(b);for(var f in e){var g=e[f].split(c),h=[];for(var i in g)h.push(g[i].replace(/\W/g,""));d.push(h)}return d}}}(window.orchid3),function(a){var b=function(a){return 0==a?1:Math.log(a)/Math.log(2)},c=function(a){this.data=a,this.entropy=void 0,this.length=this.data.length,this.cols=this.get(0).length-1,this.used=new Array(this.cols)};c.prototype={get:function(a){return this.data[a]?this.data[a]:void 0},getLength:function(){return this.length},getDecision:function(a){return this.data[void 0===a?0:a][this.cols]},getEntropy:function(){if(!this.entropy){for(var a=0,c={},d=0;d<this.length;d++){var e=this.getDecision(d);c[e]||(c[e]=0),c[e]++}for(var f in c)a-=c[f]/this.length*b(c[f]/this.length);this.entropy=a}return this.entropy},getMaxGainIndex:function(){for(var a=0,b=void 0,c=0;c<this.cols;c++)if(this.used[c]!==!0){var d=this.getGain(c);d>a&&(a=d,b=c)}return void 0!==b&&(this.used[b]=!0),b},getGain:function(a){var b=this.getSubsets(a),c=this.getEntropy();for(var d in b)c-=b[d].getLength()/this.length*b[d].getEntropy();return c},getSubsets:function(b){var c={},d={};for(var e in this.data){var f=this.data[e][b];void 0===c[f]&&(c[f]=[]),c[f].push(this.data[e])}for(var g in c)d[g]=new a.Set(c[g]);return d}},a.Set=c}(window.orchid3),function(a){var b=function(b){this.fullSet=b,this.root=new a.Node("root",this.fullSet)};b.prototype={getRoot:function(){return this.root},getSet:function(){return this.fullSet},getDecision:function(a){for(var b,c=this.root,d=0;d<=a.length;d++)if(b=c.getChild(a[d]),void 0!==b)c=b;else{var e=c.getChildren();1===e.length&&e[0].isLeaf()&&(c=e[0])}return c}},a.Tree=b}(window.orchid3),function(a){var b=0,c=function(a,c,d){this.id=b,this.children=[],this.parent=d,this.value=a,this.set=c,b++,this.build()};c.prototype={build:function(){if(this.set){var b=this.set.getEntropy();if(0==b)this.addChild(new a.Node(this.set.getDecision(),void 0,this));else{var c,d=this.set.getMaxGainIndex();if(void 0!==d){c=this.set.getSubsets(d);for(var e in c)this.addChild(new a.Node(e,c[e],this))}}}},getId:function(){return this.id},getValue:function(){return this.value},getParent:function(){return this.parent},getChildren:function(){return this.children},isRoot:function(){return void 0===this.parent},isLeaf:function(){return 0===this.children.length},addChild:function(a){this.children.push(a)},getChild:function(a){var b=void 0;for(var c in this.children)if(this.children[c].getValue()===a){b=this.children[c];break}return b}},a.Node=c}(window.orchid3),function(a){a.factory=function(b,c,d){return new a.Tree(new a.Set(a.Util.parseData(b,c||";",d||",")))}}(window.orchid3);